{% extends 'base.html.twig' %}

{% block body %}
    <h1>Serie</h1>

    <table class="table">
        <tbody>
            <tr>
                <th>Id</th>
                <td>{{ serie.id }}</td>
            </tr>
            <tr>
                <th>Title</th>
                <td>{{ serie.title }}</td>
            </tr>
            <tr>
                <th>Poster</th>
                <td><img src="{{ asset(serie.getImageName()) }}" /></td>
            </tr>
            <tr>
                <th>Resume</th>
                <td>{{ serie.resume }}</td>
            </tr>
            <tr>
                <th>Season</th>
                <td>{{ serie.season }}</td>
            </tr>
            <tr>
                <th>Episode</th>
                <td>{{ serie.episode }}</td>
            </tr>
        </tbody>
    </table>

    <ul>
        <li>
            <a href="{{ path('serie_index') }}">Back to the list</a>
        </li>
        <li>
            <a href="{{ path('serie_edit', { 'id': serie.id }) }}">Edit</a>
        </li>
        <li>
            <button id="follow">Follow</button>
        </li>
        <li>
            {{ form_start(delete_form) }}
                <input type="submit" value="Delete">
            {{ form_end(delete_form) }}
        </li>
        <li>
          {{ render( controller( "IdeatoStarRatingBundle:StarRating:displayRate", { contentId: serie.id }) ) }}
        </li>
    </ul>
    {% if is_granted("IS_AUTHENTICATED_REMEMBERED") %}
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
    <script type="text/javascript">
       $('#follow').click( function()
       {
         /**
          * Follow Ajax request
          *
          * @data : user_id
          */
         $.ajax(
           {
             url:"/ajax/follow",
             data: { id: {{ serie.id}} },
             success: function(data){
               console.log(data);
             },
             error: function(error){
               console.log(error);
             }
           }
         );
       });
     </script>
    {% include 'FOSCommentBundle:Thread:async.html.twig' with {'id': serie.id } %}
    {% else %}
      <!-- todo : outil de tradiction a mettre en place -->
      <p>
        Vous devez vous logger pour commenter cette serie.
      </p>
      <button type="button" class="btn btn-primary"><i class="fa fa-sign-in"></i> Sign in</button>&nbsp;or&nbsp;
      <button type="button" class="btn btn-primary">Sign up</button>
    {% endif %}

{% endblock %}
